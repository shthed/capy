<!DOCTYPE html>
        <html lang="en">
        <head>
          <meta charset="utf-8">
          <meta name="viewport" content="width=device-width, initial-scale=1">
          <title>Capy README</title>
          <style>
            :root {
              color-scheme: light dark;
            }
            body {
              font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", sans-serif;
              margin: 0 auto;
              padding: 32px 16px 48px;
              max-width: 920px;
              line-height: 1.6;
              background: #f6f8fa;
              color: #1f2328;
            }
            a {
              color: #0969da;
            }
            .markdown-body {
              background: #fff;
              border-radius: 12px;
              padding: 32px;
              box-shadow: 0 16px 40px rgba(15, 23, 42, 0.08);
              border: 1px solid #d0d7de;
            }
            .page-meta {
              margin-top: 24px;
              font-size: 0.85em;
              color: #57606a;
              text-align: center;
            }
            pre {
              background: #0d1117;
              color: #f0f6fc;
              padding: 16px;
              border-radius: 8px;
              overflow-x: auto;
            }
            code {
              font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;
            }
            @media (max-width: 720px) {
              .markdown-body {
                padding: 24px 20px;
              }
            }
          </style>
        </head>
        <body>
          <main class="markdown-body">
            <h1 dir="auto">Capy: Color-By-Number Playground</h1>
    <p dir="auto">A browser-based paint-by-numbers generator and player. Runs fully client-side. Usable in desktop and mobile browsers.</p>
    <p dir="auto"><a href="https://shthed.github.io/capy/" rel="nofollow">Launch Capy</a></p>
    <h2 dir="auto">Overview</h2>
    <ul dir="auto">
    <li>Converts imported images (PNG/JPG/WebP/GIF) into numbered colour regions.</li>
    <li>Bundles the Capybara Springs sample puzzle for instant play.</li>
    <li>Supports Canvas 2D, WebGL, and SVG renderers.</li>
    <li>Saves progress locally with autosave and manual snapshots.</li>
    <li>Ships a service worker for offline use on same-origin loads.</li>
    </ul>
    <h2 dir="auto">How to Play</h2>
    <ol dir="auto">
    <li>Open the app and let the Capybara Springs sample load.</li>
    <li>Select a palette tile along the bottom bar.</li>
    <li>Click/tap/pen-fill matching regions. Mouse right-click acts as an eyedropper by default.</li>
    <li>Use hints or preview to locate remaining regions.</li>
    </ol>
    <p dir="auto">Image import: drop a file anywhere or use <strong>Import</strong> in the command rail. The puzzle regenerates immediately using the new asset.</p>
    <h2 dir="auto">Offline and Install Behavior</h2>
    <ul dir="auto">
    <li><code class="notranslate">service-worker.js</code> precaches the runtime after the first HTTPS load (including the <code class="notranslate">https://capy.local/</code> alias).</li>
    <li>Cached assets enable offline play and home-screen installs; clearing site data removes the cache and resets the worker.</li>
    <li>If a deployment looks stale, perform a hard refresh to update the cache before continuing.</li>
    </ul>
    <h2 dir="auto">Key Controls</h2>
    <ul dir="auto">
    <li><strong>Mouse / Trackpad:</strong> Left-click fill, right-click eyedropper, click-drag to pan (or hold <kbd>Space</kbd>). Button mappings can be reassigned under <strong>Settings → Mouse controls</strong>.</li>
    <li><strong>Touch:</strong> Tap to paint, pinch to zoom, two-finger drag to pan. Double taps stay within the canvas area.</li>
    <li><strong>Keyboard:</strong> Arrow keys or <kbd>Tab</kbd> to move through palette colours; <kbd>Enter</kbd>/<kbd>Space</kbd> to select; <kbd>+</kbd>/<kbd>-</kbd> (or <kbd>Shift</kbd> + <kbd>=</kbd>/<kbd>-</kbd>) to zoom.</li>
    </ul>
    <h2 dir="auto">Command Rail Actions</h2>
    <ul dir="auto">
    <li>Preview finished artwork overlay.</li>
    <li>Generator tuning for palette size, smoothing, and detail.</li>
    <li>Fullscreen toggle.</li>
    <li>Import new images or Capy puzzle files.</li>
    <li>Saves management, reset, and sample reload.</li>
    <li>Help panel with manual and activity log.</li>
    <li>Settings for numbers, hints, palette sorting, renderer, and accessibility options.</li>
    </ul>
    <h2 dir="auto">Saving and Exporting</h2>
    <ul dir="auto">
    <li>Autosaves restore the last session automatically.</li>
    <li>Manual snapshots allow rename, duplicate, delete, and reload operations.</li>
    <li>Exports: JSON or compact <code class="notranslate">.capy</code> archives (<code class="notranslate">capy-export@2</code>) with compressed metadata and fill state.</li>
    <li>Reset puzzle progress without removing stored saves.</li>
    </ul>
    <h2 dir="auto">Accessibility and Comfort</h2>
    <ul dir="auto">
    <li>Palette sorting by number, remaining regions, hue, or brightness.</li>
    <li>Contrast-aware palette labels.</li>
    <li>Hint animation intensity controls.</li>
    <li>Background colour selection for contrast preferences.</li>
    <li>Renderer choice under <strong>Settings → Appearance</strong> to balance compatibility and fidelity.</li>
    </ul>
    <h2 dir="auto">Troubleshooting</h2>
    <ul dir="auto">
    <li>Blocky image: increase detail preset or palette size.</li>
    <li>Too many small regions: use Low detail preset or raise minimum region size before regenerating.</li>
    <li>Low storage: delete or export saves before clearing.</li>
    <li>Canvas stuck: hold <kbd>Space</kbd> while dragging or use two-finger pan.</li>
    <li>WebGL disabled: hardware fallback to Canvas 2D; update drivers or continue with Canvas/SVG.</li>
    </ul>
    <h2 dir="auto">Automation</h2>
    <p dir="auto"><code class="notranslate">window.capyGenerator</code> provides scripted control from the devtools console:</p>
    <div class="highlight highlight-source-js" dir="auto"><pre class="notranslate"><span class="pl-k">const</span> <span class="pl-s1">capyFixture</span> <span class="pl-c1">=</span> <span class="pl-k">await</span> <span class="pl-en">fetch</span><span class="pl-kos">(</span><span class="pl-s">"capy.json"</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">then</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-s1">r</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">r</span><span class="pl-kos">.</span><span class="pl-en">json</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-smi">window</span><span class="pl-kos">.</span><span class="pl-c1">capyGenerator</span><span class="pl-kos">.</span><span class="pl-en">loadPuzzleFixture</span><span class="pl-kos">(</span><span class="pl-s1">capyFixture</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-smi">window</span><span class="pl-kos">.</span><span class="pl-c1">capyGenerator</span><span class="pl-kos">.</span><span class="pl-en">togglePreview</span><span class="pl-kos">(</span><span class="pl-c1">true</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-smi">window</span><span class="pl-kos">.</span><span class="pl-c1">capyGenerator</span><span class="pl-kos">.</span><span class="pl-en">setRenderer</span><span class="pl-kos">(</span><span class="pl-s">"canvas"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-smi">window</span><span class="pl-kos">.</span><span class="pl-c1">capyGenerator</span><span class="pl-kos">.</span><span class="pl-en">setActiveColor</span><span class="pl-kos">(</span><span class="pl-c1">3</span><span class="pl-kos">,</span> <span class="pl-kos">{</span> <span class="pl-c1">flash</span>: <span class="pl-c1">true</span> <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-smi">window</span><span class="pl-kos">.</span><span class="pl-c1">capyGenerator</span><span class="pl-kos">.</span><span class="pl-en">fillRegion</span><span class="pl-kos">(</span><span class="pl-c1">42</span><span class="pl-kos">,</span> <span class="pl-kos">{</span> <span class="pl-c1">ensureColor</span>: <span class="pl-c1">true</span><span class="pl-kos">,</span> <span class="pl-c1">label</span>: <span class="pl-s">"qa-fill"</span> <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
    <p dir="auto">See <a href="./TECH.md#windowcapygenerator-api-reference"><code class="notranslate">TECH.md</code></a> for full API reference.</p>
    <h2 dir="auto">Testing and QA</h2>
    <p dir="auto">All tooling lives in <code class="notranslate">project/</code>.</p>
    <ul dir="auto">
    <li>Install dependencies: <code class="notranslate">cd project &amp;&amp; npm install</code>.</li>
    <li>Provision Playwright browsers: <code class="notranslate">npm run setup:playwright</code> (inside <code class="notranslate">project/</code>).</li>
    <li>Smoke and generator tests: <code class="notranslate">npm test</code> (from <code class="notranslate">project/</code>).</li>
    <li>Playwright-only quick run: <code class="notranslate">npm run test:smoke</code> (from <code class="notranslate">project/</code>).</li>
    <li>Reports: open <code class="notranslate">npx playwright show-report</code> after a run (default output <code class="notranslate">playwright-report/</code>).</li>
    </ul>
    <p dir="auto">See <code class="notranslate">project/CHANGELOG.md</code> for dated QA notes, screenshots, and links captured<br>
    alongside recent changes.</p>
    <h2 dir="auto">Local Development and Hosting</h2>
    <ul dir="auto">
    <li>Dependencies: <code class="notranslate">cd project &amp;&amp; npm install</code>.</li>
    <li>Serve repository root at <a href="http://localhost:8000" rel="nofollow">http://localhost:8000</a> with <code class="notranslate">npm run dev</code> (run inside <code class="notranslate">project/</code>). Uses <code class="notranslate">http-server</code> with caching disabled for fast reloads while exercising the service worker.</li>
    </ul>
    <h2 dir="auto">Contributing</h2>
    <p dir="auto">Review <a href="./TECH.md"><code class="notranslate">TECH.md</code></a> for architecture details. Contributor scripts and Playwright config live under <a href="./project/"><code class="notranslate">project/</code></a>. Runtime assets reside at the repository root (<code class="notranslate">index.html</code>, <code class="notranslate">styles.css</code>, <code class="notranslate">render.js</code>, <code class="notranslate">puzzle-generation.js</code>, <code class="notranslate">capy.json</code>, <code class="notranslate">service-worker.js</code>). CSS conventions live in <a href="./project/STYLEGUIDE.md"><code class="notranslate">project/STYLEGUIDE.md</code></a>.</p>
    <h2 dir="auto">Agent Guide</h2>
    <p dir="auto">See <a href="./AGENTS.md"><code class="notranslate">AGENTS.md</code></a> for the full contributor playbook. Key points:</p>
    <ul dir="auto">
    <li>Work from short-lived <code class="notranslate">automation/&lt;change&gt;</code> branches and open draft PRs early so deployments and QA notes stay aligned.</li>
    <li>Keep docs in sync: update <code class="notranslate">TECH.md</code>, <code class="notranslate">project/ROADMAP.md</code>, and <code class="notranslate">project/TODO.md</code> alongside runtime or workflow changes.</li>
    <li>Prefer straightforward implementations, perform manual smoke tests, and record which automated checks ran before handing off a review.</li>
    </ul>

          </main>
          <footer class="page-meta">Generated from README.md · 2025-11-24 11:21 UTC</footer>
        </body>
        </html>

