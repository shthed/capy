[
  {
    "id": "gameplay",
    "label": "Gameplay",
    "default": true,
    "heading": {
      "title": "Gameplay",
      "helpLabel": "Gameplay controls for preview, pacing, and assists",
      "helpText": "Tweak quick actions, pacing, and assists without leaving the puzzle."
    },
    "sections": [
      {
        "id": "quickActionsHeading",
        "title": "Quick actions",
        "layout": "actions",
        "items": [
          {
            "type": "action",
            "id": "previewToggle",
            "label": "Show preview",
            "icon": "ðŸ–¼",
            "ariaLabel": "Show preview",
            "testId": "preview-toggle",
            "ariaPressed": false,
            "disabled": true
          },
          {
            "type": "action",
            "id": "fullscreenButton",
            "label": "Enter fullscreen",
            "icon": "â›¶",
            "ariaLabel": "Enter fullscreen",
            "testId": "fullscreen-button",
            "ariaPressed": false
          }
        ],
        "note": "Manage the reference preview and fullscreen view without leaving the puzzle."
      },
      {
        "id": "gameplayHeading",
        "title": "Gameplay",
        "items": [
          {
            "type": "toggle",
            "id": "autoAdvanceToggle",
            "label": "Auto-advance to the next colour when complete",
            "checked": true
          },
          {
            "type": "toggle",
            "id": "hintFlashToggle",
            "label": "Animate hint highlights",
            "checked": true
          },
          {
            "type": "toggle",
            "id": "showRegionLabelsToggle",
            "label": "Show region numbers",
            "checked": true
          },
          {
            "type": "select",
            "id": "difficultySelect",
            "label": "Difficulty",
            "options": [
              { "value": "normal", "label": "Standard" },
              { "value": "nearby", "label": "Nearby" },
              { "value": "easy", "label": "Easy" }
            ]
          },
          {
            "type": "note",
            "text": "Nearby mode lets you click adjacent colours (for example, colour 2 can also paint 1 or 3). Easy mode auto-selects any colour you click before filling it."
          },
          {
            "type": "select",
            "id": "paletteSort",
            "label": "Sort Colours",
            "testId": "palette-sort",
            "disabled": true,
            "options": [
              { "value": "region", "label": "Number" },
              { "value": "remaining", "label": "Remaining regions" },
              { "value": "name", "label": "Colour name" },
              { "value": "spectrum", "label": "Rainbow spectrum" },
              { "value": "warmth", "label": "Warm â†’ cool" },
              { "value": "lightness", "label": "Perceptual lightness" }
            ]
          },
          { "type": "note", "text": "Choose how unfinished colours appear in the dock." }
        ]
      }
    ]
  },
  {
    "id": "hints",
    "label": "Hints",
    "heading": {
      "title": "Hints",
      "helpLabel": "Hint visibility and overlays",
      "helpText": "Control how hint highlights, overlays, and preview comparisons behave."
    },
    "sections": [
      {
        "id": "hintsControlsHeading",
        "title": "Hints & controls",
        "items": [
          {
            "type": "range",
            "id": "hintFadeDuration",
            "label": "Hint fade duration",
            "min": 400,
            "max": 2400,
            "step": 100,
            "value": 1200,
            "default": 1200,
            "format": "seconds"
          },
          { "type": "note", "text": "Set how long hint highlights linger before fading out. Default 1.2 s." },
          {
            "type": "range",
            "id": "hintIntensity",
            "label": "Hint intensity",
            "min": 20,
            "max": 90,
            "step": 5,
            "value": 65,
            "default": 65,
            "format": "percent"
          },
          { "type": "note", "text": "Adjust the opacity used when flashing matching regions. Default 65%." }
        ]
      },
      {
        "id": "hintTypesHeading",
        "title": "Hint types",
        "description": "Pick which guidance effects appear while you play.",
        "items": [
          {
            "type": "toggle",
            "id": "hintMatchingToggle",
            "label": "Highlight every region for the active colour",
            "checked": true
          },
          {
            "type": "note",
            "text": "Toggle the pulse that flashes all remaining regions sharing the selected colour."
          },
          {
            "type": "toggle",
            "id": "hintHoverToggle",
            "label": "Spotlight hovered regions",
            "checked": true
          },
          { "type": "note", "text": "Show a focused hint when you pause the pointer over a region." }
        ]
      }
    ]
  },
  {
    "id": "controls",
    "label": "Controls",
    "heading": {
      "title": "Controls",
      "helpLabel": "Control remapping and input feel",
      "helpText": "Remap mouse buttons, adjust gesture behaviour, and set interface scale."
    },
    "sections": [
      {
        "id": "mouseControlsHeading",
        "title": "Mouse controls",
        "description": "Assign actions to each mouse button when clicking or click-dragging on the canvas.",
        "items": [
          {
            "type": "mouse-controls",
            "groups": [
              {
                "title": "Left button",
                "options": [
                  {
                    "label": "Click",
                    "id": "mouseLeftClick",
                    "choices": [
                      { "value": "fill", "label": "Fill region", "selected": true },
                      { "value": "select-fill", "label": "Select and fill region" },
                      { "value": "select", "label": "Select colour" },
                      { "value": "zoom-in", "label": "Zoom in" },
                      { "value": "zoom-out", "label": "Zoom out" },
                      { "value": "none", "label": "No action" }
                    ]
                  },
                  {
                    "label": "Click + drag",
                    "id": "mouseLeftDrag",
                    "choices": [
                      { "value": "pan", "label": "Pan view", "selected": true },
                      { "value": "fill", "label": "Fill while dragging" },
                      { "value": "zoom", "label": "Zoom" },
                      { "value": "none", "label": "No action" }
                    ]
                  }
                ]
              },
              {
                "title": "Middle button",
                "options": [
                  {
                    "label": "Click",
                    "id": "mouseMiddleClick",
                    "choices": [
                      { "value": "fill", "label": "Fill region" },
                      { "value": "select-fill", "label": "Select and fill region" },
                      { "value": "select", "label": "Select colour" },
                      { "value": "zoom-in", "label": "Zoom in" },
                      { "value": "zoom-out", "label": "Zoom out" },
                      { "value": "none", "label": "No action", "selected": true }
                    ]
                  },
                  {
                    "label": "Click + drag",
                    "id": "mouseMiddleDrag",
                    "choices": [
                      { "value": "pan", "label": "Pan view", "selected": true },
                      { "value": "fill", "label": "Fill while dragging" },
                      { "value": "zoom", "label": "Zoom" },
                      { "value": "none", "label": "No action" }
                    ]
                  }
                ]
              },
              {
                "title": "Right button",
                "options": [
                  {
                    "label": "Click",
                    "id": "mouseRightClick",
                    "choices": [
                      { "value": "fill", "label": "Fill region" },
                      { "value": "select-fill", "label": "Select and fill region" },
                      { "value": "select", "label": "Select colour", "selected": true },
                      { "value": "zoom-in", "label": "Zoom in" },
                      { "value": "zoom-out", "label": "Zoom out" },
                      { "value": "none", "label": "No action" }
                    ]
                  },
                  {
                    "label": "Click + drag",
                    "id": "mouseRightDrag",
                    "choices": [
                      { "value": "pan", "label": "Pan view", "selected": true },
                      { "value": "fill", "label": "Fill while dragging" },
                      { "value": "zoom", "label": "Zoom" },
                      { "value": "none", "label": "No action" }
                    ]
                  }
                ]
              }
            ]
          },
          { "type": "note", "text": "Drag-to-zoom adjusts the view by moving up to zoom in or down to zoom out." }
        ]
      }
    ]
  },
  {
    "id": "appearance",
    "label": "Appearance",
    "heading": {
      "title": "Appearance",
      "helpLabel": "Appearance and accessibility controls",
      "helpText": "Balance scale, contrast, overlays, and theme picks for the board."
    },
    "sections": [
      {
        "id": "appearanceHeading",
        "title": "Appearance",
        "items": [
          {
            "type": "range",
            "id": "uiScale",
            "label": "Interface scale",
            "min": 0.2,
            "max": 3,
            "step": 0.05,
            "value": 0.75,
            "default": 0.75,
            "format": "unit-percent"
          },
          { "type": "note", "text": "Resize command buttons and labels without altering canvas zoom. Default 75%." },
          {
            "type": "range",
            "id": "labelScale",
            "label": "Label size",
            "min": 0.2,
            "max": 2,
            "step": 0.05,
            "value": 1,
            "default": 1,
            "format": "unit-percent"
          },
          { "type": "note", "text": "Scale region numbers independently from the surrounding interface. Default 100%." },
          {
            "type": "range",
            "id": "maxZoom",
            "label": "Maximum zoom",
            "min": 2,
            "max": 30,
            "step": 0.5,
            "value": 12,
            "default": 12,
            "format": "zoom-percent"
          },
          { "type": "note", "text": "Limit how far the canvas can zoom in beyond the fitted view. Default 1200%." },
          {
            "type": "select",
            "id": "uiTheme",
            "label": "Interface theme",
            "options": [
              { "value": "dark", "label": "Dark", "selected": true },
              { "value": "light", "label": "Light" },
              { "value": "colorful", "label": "Colourful" }
            ]
          },
          { "type": "note", "text": "Switch between dark, light, or colourful chrome accents." },
          {
            "type": "select",
            "id": "rendererMode",
            "label": "Renderer",
            "options": [
              { "value": "svg", "label": "SVG", "selected": true }
            ]
          },
          { "type": "note", "text": "Rendering is handled by the simplified SVG backend." },
          {
            "type": "color",
            "id": "backgroundColor",
            "label": "Unfilled region colour",
            "value": "#f8fafc"
          },
          { "type": "note", "text": "Applies to unfinished regions and adjusts outline contrast automatically." },
          { "type": "color", "id": "stageBackgroundColor", "label": "Background", "value": "#000000" },
          { "type": "note", "text": "Adjust the area surrounding the puzzle canvas." }
        ]
      }
    ]
  },
  {
    "id": "generator",
    "label": "Generator",
    "heading": {
      "title": "Generator",
      "helpLabel": "Generator and import controls",
      "helpText": "Set clustering, imports, and metadata for new puzzles and reloads."
    },
    "blocks": [
      { "type": "import-notice" },
      {
        "type": "section",
        "id": "generatorHeading",
        "title": "Clustering & detail",
        "description": "Tune the colour clustering pipeline that powers new puzzles. These settings apply to fresh imports and the bundled capybara sample when reloaded.",
        "items": [
          {
            "type": "detail-callout",
            "captionAttr": "detail-caption",
            "levels": [
              { "level": "low", "label": "Low" },
              { "level": "medium", "label": "Medium" },
              { "level": "high", "label": "High" }
            ]
          },
          { "type": "note", "text": "Switching presets updates every slider below and reloads the sample scene when it's active." },
          {
            "type": "range",
            "id": "colorCount",
            "label": "Colours",
            "min": 4,
            "max": 64,
            "value": 12,
            "default": 12,
            "format": "integer"
          },
          {
            "type": "range",
            "id": "minRegion",
            "label": "Regions",
            "min": 1,
            "max": 600,
            "value": 60,
            "default": 60,
            "format": "px2"
          },
          { "type": "note", "text": "Higher values merge smaller areas for fewer regions. Default 60 pxÂ²." },
          {
            "type": "range",
            "id": "detailLevel",
            "label": "Detail",
            "min": 256,
            "max": 1600,
            "step": 64,
            "value": 640,
            "default": 640,
            "format": "px"
          },
          { "type": "note", "text": "Controls the longest edge used when resizing the source image. Default 640 px." },
          {
            "type": "select",
            "id": "generationAlgorithm",
            "label": "Algorithm",
            "options": [
              { "value": "local-kmeans", "label": "Local palette clustering (k-means)" },
              { "value": "local-posterize", "label": "Local posterize & merge" },
              { "value": "organic-slic", "label": "Organic superpixels (curved gradients)" }
            ]
          },
          { "type": "note", "text": "Choose between local clustering pipelines now, with space for hosted services to appear as they become available." },
          {
            "type": "range",
            "id": "sampleRate",
            "label": "Sample rate",
            "min": 25,
            "max": 100,
            "step": 5,
            "value": 50,
            "default": 50,
            "format": "percent"
          },
          { "type": "note", "text": "Lower values speed up clustering by sampling fewer pixels. Default 50%." },
          {
            "type": "range",
            "id": "kmeansIters",
            "label": "Iterations",
            "min": 4,
            "max": 32,
            "step": 1,
            "value": 12,
            "default": 12,
            "format": "integer"
          },
          {
            "type": "note",
            "text": "Iterations rerun the clustering stage; higher counts refine colour centroids but take longer to process. Default 12 iterations."
          },
          {
            "type": "range",
            "id": "smoothingPasses",
            "label": "Smoothing passes",
            "min": 0,
            "max": 4,
            "step": 1,
            "value": 0,
            "default": 0,
            "format": "integer"
          },
          {
            "type": "note",
            "text": "Each pass blends stray pixels into neighbouring regions before segmentationâ€”set to 0 to keep edges as crisp as the source. Default 0 passes."
          },
          {
            "type": "details",
            "summary": "Advanced options",
            "items": [
              {
                "type": "range",
                "id": "mergePasses",
                "label": "Merge passes",
                "min": 1,
                "max": 24,
                "step": 1,
                "value": 12,
                "default": 12,
                "format": "integer"
              },
              {
                "type": "note",
                "text": "Limits how many merge sweeps run after segmentation to avoid oscillation. Default 12 passes."
              },
              {
                "type": "range",
                "id": "perimeterRatio",
                "label": "Perimeter/area limit",
                "min": 0,
                "max": 3,
                "step": 0.05,
                "value": 1.6,
                "default": 1.6,
                "format": "ratio"
              },
              {
                "type": "note",
                "text": "Regions above this perimeter-to-area ratio merge into dominant neighbours; set to 0 to disable. Default 1.6."
              },
              {
                "type": "textarea",
                "id": "artPrompt",
                "label": "Art prompt",
                "rows": 3,
                "placeholder": "Summarise the idea behind this puzzle"
              },
              {
                "type": "note",
                "text": "Stored with saves so you can revisit the inspiration that sparked the artwork."
              },
              {
                "type": "textarea",
                "id": "imageDescription",
                "label": "Image description",
                "rows": 3,
                "placeholder": "Describe the image you want to generate"
              },
              {
                "type": "note",
                "text": "Stored with saves and exports so you can revisit the inspiration later."
              },
              {
                "type": "note",
                "link": {
                  "href": "https://chat.openai.com/",
                  "text": "Open ChatGPT to craft an image prompt",
                  "id": "chatGptLink"
                }
              }
            ]
          }
        ]
      },
      { "type": "source-url-form" },
      { "type": "sheet-actions" },
      { "type": "generator-progress" }
    ]
  },
  {
    "id": "saves",
    "label": "Saves",
    "heading": {
      "title": "Saves",
      "helpLabel": "Save management",
      "helpText": "Import puzzles, start fresh sessions, and manage your save slots."
    },
    "sections": [
      {
        "id": "saveStartHeading",
        "title": "Start a puzzle",
        "items": [
          {
            "type": "action-row",
            "className": "save-start-actions",
            "actions": [
              { "type": "button", "id": "selectImage", "label": "Upload Image", "ariaLabel": "Upload image or JSON puzzle" },
              { "type": "button", "id": "samplePuzzle", "label": "Load capybara sample", "ariaLabel": "Load capybara sample puzzle", "dataset": { "action": "load-sample" } }
            ]
          }
        ]
      },
      { "type": "save-manager" },
      {
        "id": "storageHeading",
        "title": "Save storage",
        "items": [
          { "type": "note", "text": "", "outputId": "saveStorageSummary" },
          {
            "type": "select",
            "id": "sourceImageLimit",
            "label": "Stored image size",
            "outputFor": "sourceImageLimit",
            "options": [
              { "value": 262144, "label": "256 KB" },
              { "value": 524288, "label": "512 KB" },
              { "value": 1048576, "label": "1 MB", "selected": true },
              { "value": 2097152, "label": "2 MB" },
              { "value": 5242880, "label": "5 MB" }
            ]
          },
          {
            "type": "note",
            "text": "Caps the compressed original image that ships with saves and exports. Changes apply to the next puzzle you generate or import."
          },
          {
            "type": "button-row",
            "className": "log-actions",
            "actions": [
              { "type": "button", "id": "deleteAllSaves", "label": "Delete all saves" }
            ]
          }
        ]
      }
    ]
  },
  {
    "id": "help",
    "label": "Help",
    "heading": {
      "title": "Help",
      "helpLabel": "Gameplay tips",
      "helpText": "Review button legends and gestures while you play."
    },
    "sections": [
      {
        "id": "commandsHeading",
        "title": "Command buttons",
        "items": [
          {
            "type": "definition-list",
            "items": [
              { "term": "ðŸ–¼ Preview", "description": "Toggle the finished artwork overlay to compare your progress." },
              {
                "term": "ðŸŽ› Generator",
                "description": "Adjust clustering sliders, choose capybara detail presets, reload the current source image, and monitor generation progress. The sheet mirrors the k-means pipeline inputs used for puzzle creation."
              },
              {
                "term": "ðŸŽš Detail",
                "description": "Toggle the capybara detail chips in the Generator sheet to reload the sample with tuned palette sizes, minimum region areas, resize targets, and the region counts noted above."
              },
              { "term": "â›¶ Fullscreen", "description": "Expand the app to fill the display or exit back to windowed mode." },
              { "term": "â¬† Import", "description": "Load a new image or JSON puzzle from disk." },
              { "term": "ðŸ’¾ Saves", "description": "Manage snapshots â€” load, rename, export, or delete stored games." },
              { "term": "â„¹ Help", "description": "Open this guide and review tips for palette controls, gestures, and shortcuts." },
              {
                "term": "âš™ Menu",
                "description": "Toggle auto-advance, customise hints, change the background or theme, sort the palette, and adjust the interface scale. Advanced options expose accessibility tweaks for the hint animations."
              }
            ]
          }
        ]
      },
      {
        "id": "controlsHeading",
        "title": "Canvas controls",
        "items": [
          {
            "type": "list",
            "items": [
              "Click Fill the tapped region if it matches the active colour.",
              "Right click Select the colour under the pointer.",
              "Select a palette swatch to set the active colour and flash every matching region.",
              "Enable Easy difficulty in the menu to let clicks auto-select the tapped region's colour.",
              "Mouse wheel or +/âˆ’ Zoom in or out around the cursor.",
              "Middle click or Space + drag Pan the canvas.",
              "Drag & drop an image or JSON file anywhere on the window to import it."
            ]
          }
        ]
      }
    ]
  },
  {
    "id": "diagnostics",
    "label": "Diagnostics",
    "heading": {
      "title": "Diagnostics",
      "helpLabel": "Diagnostics and JSON review",
      "helpText": "Check live logs, system status, and review the current JSON payload."
    },
    "blocks": [
      { "type": "loader-console" },
      {
        "type": "section",
        "id": "systemHeading",
        "title": "System status",
        "items": [
          {
            "type": "definition-list",
            "items": [
              { "term": "Service worker", "description": "Waiting to registerâ€¦", "dataTarget": "service-worker-state" },
              { "term": "Runtime cache", "description": "capy-offline-cache-v3", "dataTarget": "service-worker-cache" },
              { "term": "Last update", "description": "Not available yet", "dataTarget": "service-worker-updated" }
            ]
          },
          {
            "type": "note",
            "text": "Service worker registration, cache limits, and install events stream into the debug log below."
          }
        ]
      },
      {
        "type": "section",
        "id": "debugHeading",
        "title": "Debug log",
        "items": [
          { "type": "note", "text": "Recent actions, selections, and generation events appear here while you play." },
          { "type": "logger", "id": "debugLog" },
          {
            "type": "button-row",
            "className": "log-actions",
            "actions": [ { "type": "button", "id": "clearDebugLog", "label": "Clear log" } ]
          }
        ]
      },
      {
        "type": "section",
        "id": "settingsJsonHeading",
        "title": "Preferences JSON",
        "items": [
          {
            "type": "note",
            "text": "Review or update the current preferences as JSON. Export a snapshot or import one from the textarea below."
          },
          { "type": "json-view" }
        ]
      }
    ]
  }
]
